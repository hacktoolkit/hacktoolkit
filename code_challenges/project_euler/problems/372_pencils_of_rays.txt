http://projecteuler.net/problem=372

Pencils of rays


Let R(M, N) be the number of lattice points (x, y) which satisfy MxN, MyN and  is odd.
We can verify that R(0, 100) = 3019 and R(100, 10000) = 29750422.
Find R(2Â·106, 109).


Note:  represents the floor function.

