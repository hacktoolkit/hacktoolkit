/*
HTTP Host: static.ak.fbcdn.net
Generated: June 1st 2010 9:14:58 AM PDT
Machine: 10.16.140.104
Locale: nu_ll
Path: js/61k4eem494g8ogko.pkg.js
*/

((location=='about:blank'&&(window.parent.eval_global||window.parent.eval))||(window.eval_global||window.eval))("if (window.CavalryLogger) { CavalryLogger.start_js([\"js\\\/61k4eem494g8ogko.pkg.js\"]); }\n\nfunction ads_refresh(l,g,f,h,m,k,j){if(window.ads_refreshing)return;if(m===undefined)m=0;if(j===undefined)j=0;var i=['sidebar_ads','home_sponsor_nile','ego'];var e=[];for(var d=0;d<i.length;d++)if(ge(i[d]))e.push(i[d]);if(e.length==0)return;var c={page:g,queryId:j,tab:l,locations:e,photo_refresh:(h?'yes':'no'),cache:m};var b=function(r,q){window.ads_refreshing=false;if(!r){var n=q.getPayload();for(var p in n){var o=ge(p);if(o&&n[p].length>0)if(ua.ie()<7){o.outerHTML=n[p];}else DOM.replace(o,HTML(n[p]));}}if(f)f(q);}.curry(k);var a=function(n){window.ads_refreshing=false;};new AsyncRequest().setURI('\/ajax\/location_refresh.php').setData(c).setOption('bundle',true).setHandler(b).setErrorHandler(a).send();window.ads_refreshing=true;}\nfunction typeaheadpro(a,c,b){if(!typeaheadpro.hacks){typeaheadpro.should_check_missing_events=ua.safari()<500;typeaheadpro.should_simulate_keypress=ua.ie()||(ua.safari()>500&&ua.safari()<523||ua.safari()>=525);if(typeaheadpro.should_use_iframe==undefined)typeaheadpro.should_use_iframe=ua.ie()<7;typeaheadpro.should_use_overflow=ua.opera()<9.5||ua.safari()<500;if(ua.firefox())this.activate_poll_on_focus_events=true;typeaheadpro.hacks=true;}typeaheadpro.instances=(typeaheadpro.instances||[]);typeaheadpro.instances.push(this);this.instance=typeaheadpro.instances.length-1;copy_properties(this,b||{});this.obj=a;this.obj.typeahead=this;this.attachEventListeners();this.want_icon_list=false;this.showing_icon_list=false;this.stop_suggestion_select=false;if(this.typeahead_icon_class&&this.typeahead_icon_get_return){this.typeahead_icon=document.createElement('div');CSS.addClass(this.typeahead_icon,'typeahead_list_icon');CSS.addClass(this.typeahead_icon,this.typeahead_icon_class);this.typeahead_icon.innerHTML='&nbsp;';this.setup_typeahead_icon();setTimeout(function(){this.focus();}.bind(this),50);this.typeahead_icon.onmousedown=function(event){return this.typeahead_icon_onclick(event||window.event);}.bind(this);}this.focused=this.focused||this.obj.offsetWidth?true:false;this.focused=this.focused&&!this.enumerate_on_focus;this.anchor=this.setup_anchor();this.dropdown=document.createElement('div');CSS.addClass(this.dropdown,'typeahead_list');if(!this.focused)this.dropdown.style.display='none';this.anchor_block=this.anchor_block||this.anchor.tagName.toLowerCase()=='div';document.body.appendChild(this.dropdown);this.dropdown.className+=' typeahead_list_absolute';this.list=$N('div');this.dropdown.appendChild(this.list);this.dropdown.onmousedown=function(event){return this.dropdown_onmousedown(event||window.event);}.bind(this);if(typeaheadpro.should_use_iframe&&!typeaheadpro.iframe){typeaheadpro.iframe=document.createElement('iframe');typeaheadpro.iframe.src=\"\/common\/blank.html\";CSS.setClass(typeaheadpro.iframe,'typeahead_iframe');typeaheadpro.iframe.style.display='none';typeaheadpro.iframe.frameBorder=0;document.body.appendChild(typeaheadpro.iframe);}if(typeaheadpro.should_use_iframe&&typeaheadpro.iframe)typeaheadpro.iframe.style.zIndex=parseInt(CSS.getStyle(this.dropdown,'zIndex'))-1;this.log_data={kt:0,kp:0,sm:null,ty:0,f:1};this.results_text='';this.last_key_suggestion=0;this.status=typeaheadpro.STATUS_BLOCK_ON_SOURCE_BOOTSTRAP;this.clear_placeholder();if(c)this.set_source(c);if(this.source){this.selectedindex=-1;if(this.focused){this._onfocus();this.show();this._onkeyup();this.set_class('');this.capture_submit();}}else this.hide();onunloadRegister(this._onunload.bind(this),true);}typeaheadpro.prototype.enumerate=false;typeaheadpro.prototype.interactive=false;typeaheadpro.prototype.changed=false;typeaheadpro.prototype.render_block_size=50;typeaheadpro.prototype.typeahead_icon_class=false;typeaheadpro.prototype.typeahead_icon_get_return=false;typeaheadpro.prototype.old_value=null;typeaheadpro.prototype.poll_handle=null;typeaheadpro.prototype.activate_poll_on_focus_events=false;typeaheadpro.prototype.suggestion_count=0;typeaheadpro.STATUS_IDLE=0;typeaheadpro.STATUS_WAITING_ON_SOURCE=1;typeaheadpro.STATUS_BLOCK_ON_SOURCE_BOOTSTRAP=2;typeaheadpro.prototype.clear_value_on_blur=true;typeaheadpro.prototype.max_results=0;typeaheadpro.prototype.max_display=10;typeaheadpro.prototype.allow_placeholders=false;typeaheadpro.prototype.auto_select=true;typeaheadpro.prototype.auto_select_exactmatch=false;typeaheadpro.prototype.enumerate_on_focus=false;typeaheadpro.dirty_instances=function(){if(typeaheadpro.instances)typeaheadpro.instances.forEach(function(a){a.update_status(typeaheadpro.STATUS_BLOCK_ON_SOURCE_BOOTSTRAP);if(a.source)a.source.is_ready=false;});};typeaheadpro.prototype.set_source=function(a){this.source=a;this.source.set_owner(this);this.status=typeaheadpro.STATUS_IDLE;this.cache={};this.last_search=0;this.suggestions=[];};typeaheadpro.prototype.setup_anchor=function(){return this.obj;};typeaheadpro.prototype.destroy=function(){if(this.typeahead_icon){DOM.remove(this.typeahead_icon);this.toggle_icon_list=function(){};}this.clear_render_timeouts();if(!this.anchor_block&&this.anchor.nextSibling.tagName.toLowerCase()=='br')DOM.remove(this.anchor.nextSibling);if(this.dropdown)DOM.remove(this.dropdown);if(this.obj){this.obj.onfocus=this.obj.onblur=this.obj.onkeyup=this.obj.onkeydown=this.obj.onkeypress=this.obj.typeahead=null;DOM.remove(this.obj);}this.anchor=this.obj=this.dropdown=null;delete typeaheadpro.instances[this.instance];};typeaheadpro.prototype.check_value=function(){if(this.obj){var a=this.obj.value;if(a!=this.old_value){this.dirty_results();this.old_value=a;if(this.old_value==='')this._onselect(false);}}};typeaheadpro.prototype._onkeyup=function(a){a=$E(a);this.last_key=a?a.keyCode:-1;if(this.key_down==this.last_key)this.key_down=0;var b=true;switch(this.last_key){case KEYS.ESC:this.selectedindex=-1;this._onselect(false);this.hide();a.stop();b=false;break;}return b;};typeaheadpro.prototype._onkeydown=function(a){a=$E(a);this.key_down=this.last_key=a?a.keyCode:-1;this.interactive=true;switch(this.last_key){case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:case KEYS.UP:case KEYS.DOWN:this.log_data.kt+=1;if(typeaheadpro.should_simulate_keypress)this._onkeypress({keyCode:this.last_key});return false;case KEYS.TAB:this.log_data.kt+=1;this.select_suggestion(this.selectedindex);if(a.shiftKey){this.reverse_focus();}else this.advance_focus();break;case KEYS.RETURN:this.log_data.sm='key_ret';if(this.select_suggestion(this.selectedindex))this.hide();if(typeof(this.submit_keydown_return)!='undefined')this.submit_keydown_return=this._onsubmit(this.get_current_selection());return this.submit_keydown_return;case 229:if(!this.poll_handle)this.poll_handle=setInterval(this.check_value.bind(this),100);break;default:this.log_data.kp+=1;setTimeout(bind(this,'check_value'),this.source.check_limit);}};typeaheadpro.prototype._onkeypress=function(a){a=$E(a);var b=1;this.last_key=a?Event.getKeyCode(a):-1;this.interactive=true;switch(this.last_key){case KEYS.PAGE_UP:b=this.max_display;case KEYS.UP:this.set_suggestion(b>1&&this.selectedindex>0&&this.selectedindex<b?0:this.selectedindex-b);this.last_key_suggestion=(new Date()).getTime();return false;case KEYS.PAGE_DOWN:b=this.max_display;case KEYS.DOWN:if(trim(this.get_value())==''&&!this.enumerate){this.enumerate=true;this.results_text=null;this.dirty_results();}else{this.set_suggestion(this.suggestions.length<=this.selectedindex+b?this.suggestions.length-1:this.selectedindex+b);this.last_key_suggestion=(new Date()).getTime();}return false;case KEYS.RETURN:var c=null;if(typeof(this.submit_keydown_return)=='undefined'){c=this.submit_keydown_return=this._onsubmit(this.get_current_selection());}else{c=this.submit_keydown_return;delete this.submit_keydown_return;}a.stop();return c;default:setTimeout(bind(this,'check_value'),this.source.check_limit);break;}return true;};typeaheadpro.prototype._onchange=function(){this.changed=true;};typeaheadpro.prototype._onfound=function(a){return this.onfound?this.onfound.call(this,a):true;};typeaheadpro.prototype._onsubmit=function(a){if(this.onsubmit){var b=this.onsubmit.call(this,a);if(b&&this.obj.form){if(!this.obj.form.onsubmit||this.obj.form.onsubmit())this.obj.form.submit();return false;}return b;}else{this.advance_focus();return false;}};typeaheadpro.prototype._onselect=function(c){var b=(function(){if(this.onselect)this.onselect.call(this,c);}).bind(this);if(c.no_email){var a=new AsyncRequest().setData({action:'require',require_field:'email',uid:c.i}).setMethod('GET').setReadOnly(true).setURI('\/friends\/ajax\/external.php');new Dialog().setCloseHandler(function(e){var d=this.getUserData();if(d){b();}else e.set_value('');}.bind(null,this)).setAsync(a).show();}else b();};typeaheadpro.prototype._onfocus=function(){if(!this.poll_handle&&this.activate_poll_on_focus_events)this.poll_handle=setInterval(this.check_value.bind(this),100);if(this.source)this.source.bootstrap();if(this.last_dropdown_mouse>(new Date()).getTime()-10||this.focused)return;if(this.changed)this.dirty_results();this.focused=true;this.changed=false;this.clear_placeholder();this.results_text='';this.set_class('');this.show();this.capture_submit();if(this.typeahead_icon)show(this.typeahead_icon);if(this.enumerate_on_focus)setTimeout(function(){this.enumerate=true;this.results_text=null;this.dirty_results();this.selectedindex=-1;return false;}.bind(this),0);};typeaheadpro.prototype._onblur=function(event){if(this.last_dropdown_mouse&&this.last_dropdown_mouse>(new Date()).getTime()-10&&this.is_showing_suggestions()){Event.kill(event);setTimeout(function(){this.focus();}.bind(this),0);return false;}if(!this.stop_hiding){if(this.showing_icon_list)this.toggle_icon_list(true);}else{this.focus();return false;}this.focused=false;if(this.changed&&!this.interactive){this.dirty_results();this.changed=false;return;}if(!this.suggestions){this._onselect(false);}else if(this.selectedindex>=0&&(this.auto_select||this.auto_select_exactmatch))this.select_suggestion(this.selectedindex);this.hide();this.update_class();if(this.clear_value_on_blur&&!this.get_value()){var a=this.allow_placeholders?this.source.gen_noinput():'';this.set_value(a?a:'');this.set_class('DOMControl_placeholder');}if(this.poll_handle){clearInterval(this.poll_handle);this.poll_handle=null;}};typeaheadpro.prototype._onunload=function(){if(typeaheadpro.instances[this.instance])this.hide();};typeaheadpro.prototype.typeahead_icon_onclick=function(event){this.stop_hiding=true;this.focus();setTimeout(function(){this.toggle_icon_list();}.bind(this),50);Event.kill(event);return false;};typeaheadpro.prototype.dropdown_onmousedown=function(event){this.last_dropdown_mouse=(new Date()).getTime();};typeaheadpro.prototype.setup_typeahead_icon=function(){this.typeahead_parent=document.createElement('div');CSS.addClass(this.typeahead_parent,'typeahead_parent');this.typeahead_parent.appendChild(this.typeahead_icon);this.obj.parentNode.insertBefore(this.typeahead_parent,this.obj);};typeaheadpro.prototype.mouse_set_suggestion=function(a){if(!this.visible)return;if((new Date()).getTime()-this.last_key_suggestion>50)this.set_suggestion(a);};typeaheadpro.prototype.capture_submit=function(){if(!typeaheadpro.should_check_missing_events)return;if((!this.captured_form||this.captured_substitute!=this.captured_form.onsubmit)&&this.obj.form){this.captured_form=this.obj.form;this.captured_event=this.obj.form.onsubmit;this.captured_substitute=this.obj.form.onsubmit=function(){return ((this.key_down&&this.key_down!=KEYS.RETURN&&this.key_down!=KEYS.TAB)?this.submit_keydown_return:(this.captured_event?this.captured_event.apply(arguments,this.captured_form):true))?true:false;}.bind(this);}};typeaheadpro.prototype.set_suggestion=function(b){this.stop_suggestion_select=false;if(!this.suggestions||this.suggestions.length<=b)return;var c=this.get_suggestion_node(this.selectedindex);this.selectedindex=(b<=-1)?-1:b;var a=this.get_suggestion_node(this.selectedindex);if(c){CSS.removeClass(c,'typeahead_selected');CSS.addClass(c,'typeahead_not_selected');}if(a){CSS.removeClass(a,'typeahead_not_selected');CSS.addClass(a,'typeahead_selected');}this.recalc_scroll();this._onfound(this.get_current_selection());};typeaheadpro.prototype.get_suggestion_node=function(a){var b=this.list.childNodes;return a==-1?null:b[Math.floor(a\/this.render_block_size)].childNodes[a%this.render_block_size];};typeaheadpro.prototype.get_current_selection=function(){return this.selectedindex==-1?false:this.suggestions[this.selectedindex];};typeaheadpro.prototype.update_class=function(){if(this.suggestions&&this.selectedindex!=-1&&typeahead_source.flatten_string(this.get_current_selection().t)==typeahead_source.flatten_string(this.get_value())){this.set_class('typeahead_found');}else this.set_class('');};typeaheadpro.prototype.select_suggestion=function(a){if(!this.stop_suggestion_select&&this.current_selecting!=a)this.current_selecting=a;var b=true;if(!this.suggestions||a==undefined||a===false||this.suggestions.length<=a||a<0){this._onfound(false);this._onselect(false);this.selectedindex=-1;this.set_class('');b=false;}else{this.selectedindex=a;var c=this.suggestions[a].ty;if(c!='web'&&c!='search')this.set_value(this.suggestions[a].t);this.set_class('typeahead_found');this._onfound(this.suggestions[this.selectedindex]);this._onselect(this.suggestions[this.selectedindex]);}if(!this.interactive){this.hide();this.blur();}this.current_selecting=null;if(!b&&this.ignore_invalid_suggestion)return false;return true;};typeaheadpro.prototype.is_showing_suggestions=function(){return (this.suggestions)&&(this.suggestions.length>0);};typeaheadpro.prototype.set_value=function(a){this.obj.value=a;};typeaheadpro.prototype.get_value=function(){if(this.showing_icon_list&&this.old_typeahead_value!=this.obj.value)this.toggle_icon_list();if(this.want_icon_list){return this.typeahead_icon_get_return;}else if(this.showing_icon_list)this.toggle_icon_list();return this.obj.value;};typeaheadpro.prototype.found_suggestions=function(m,n,c){if(!m)m=[];this.suggestion_count=m.length;if(!c){this.status=typeaheadpro.STATUS_IDLE;this.add_cache(n,m);}this.clear_render_timeouts();if(this.get_value()==this.results_text){return;}else if(!c){this.results_text=typeahead_source.flatten_string(n);if(this.enumerate&&trim(this.results_text)!='')this.enumerate=false;}var b=-1;if(this.selectedindex>0||(this.selectedindex==0&&!this.auto_select)){var k=this.suggestions[this.selectedindex].i;for(var f=0,g=m.length;f<g;f++)if(m[f].i==k){b=f;break;}}if(b==-1&&this.auto_select&&m.length){b=0;this._onfound(m[0]);}else if(this.auto_select_exactmatch&&m.length)if(n.toLowerCase()===m[0].t.toLowerCase()){b=0;this._onfound(m[0]);}else b=-1;this.selectedindex=b;this.suggestions=m;if(!c)this.real_suggestions=m;if(m.length){var e=[],a=Math.ceil(m.length\/this.render_block_size),h={},d,j=null;DOM.empty(this.list);for(var f=0;f<a;f++)this.list.appendChild(document.createElement('div'));if(b>-1){d=Math.floor(b\/this.render_block_size);h[d]=true;if(b%this.render_block_size>this.render_block_size\/2){h[d+1]=true;}else if(d!=0)h[d-1]=true;}else h[0]=true;for(var i in h){this.render_block(i);sample=this.list.childNodes[i].firstChild;}this.show();if(a){var l=sample.offsetHeight;this.render_timeouts=[];for(var f=1;f<a;f++)if(!h[f]){this.list.childNodes[f].style.height=l*Math.min(this.render_block_size,m.length-f*this.render_block_size)+'px';this.render_timeouts.push(setTimeout(this.render_block.bind(this,f),700+f*50));}}}else{this.selectedindex=-1;this.set_message(this.status==typeaheadpro.STATUS_IDLE?this.source.gen_nomatch():this.source.gen_loading());this._onfound(false);}this.recalc_scroll();if(!c&&this.results_text!=typeahead_source.flatten_string(this.get_value()))this.dirty_results();};typeaheadpro.prototype.render_block=function(a,h){var i=this.suggestions,g=this.selectedindex,j=this.get_value(),d=this.instance,b=[],f=this.list.childNodes[a];for(var c=a*this.render_block_size,e=Math.min(i.length,(a+1)*this.render_block_size);c<e;c++){b.push('<div class=\"');if(g==c){b.push('typeahead_suggestion typeahead_selected');}else b.push('typeahead_suggestion typeahead_not_selected');if(c>0&&i[c-1].o<0&&i[c].o>=0)b.push(' typeahead_delimiter');b.push('\" onmouseover=\"typeaheadpro.instances[',d,'].mouse_set_suggestion(',c,')\" ','onmousedown=\"var instance=typeaheadpro.instances[',d,']; instance.select_suggestion(',c,');instance.hide();Event.kill(event);\">',this.source.gen_html(i[c],j),'<\/div>');}f.innerHTML=b.join('');f.style.height='auto';CSS.addClass(f,'typeahead_suggestions');};typeaheadpro.prototype.clear_render_timeouts=function(){if(this.render_timeouts){for(var a=0;a<this.render_timeouts.length;a++)clearTimeout(this.render_timeouts[a]);this.render_timeouts=null;}};typeaheadpro.prototype.recalc_scroll=function(){var a=this.list.firstChild;if(!a)return;if(a.childNodes.length>this.max_display){var c=a.childNodes[this.max_display-1];var b=c.offsetTop+c.offsetHeight;this.dropdown.style.height=b+'px';var e=this.get_suggestion_node(this.selectedindex);if(e){var d=this.dropdown.scrollTop;if(e.offsetTop<d){this.dropdown.scrollTop=e.offsetTop;}else if(e.offsetTop+e.offsetHeight>b+d)this.dropdown.scrollTop=e.offsetTop+e.offsetHeight-b;}if(!typeaheadpro.should_use_overflow){this.dropdown.style.overflowY='scroll';this.dropdown.style.overflowX='hidden';}}else{this.dropdown.style.height='auto';if(!typeaheadpro.should_use_overflow)this.dropdown.style.overflowY='hidden';}};typeaheadpro.prototype.search_cache=function(a){return this.cache[typeahead_source.flatten_string(a)];};typeaheadpro.prototype.add_cache=function(b,a){if(this.source.cache_results)this.cache[typeahead_source.flatten_string(b)]=a;};typeaheadpro.prototype.update_status=function(a){this.status=a;this.dirty_results();};typeaheadpro.prototype.set_class=function(a){CSS.setClass(this.obj,(this.obj.className.replace(\/typeahead_[^\\s]+\/g,'')+' '+a).replace(\/ {2,}\/g,' '));};typeaheadpro.prototype.dirty_results=function(){if(!this.enumerate&&this.get_value().trim()==''){DOM.empty(this.list);this.results_text='';this.set_message(this.source.gen_placeholder());this.suggestions=[];this.selectedindex=-1;return;}else if(this.results_text==typeahead_source.flatten_string(this.get_value())){return;}else if(this.status==typeaheadpro.STATUS_BLOCK_ON_SOURCE_BOOTSTRAP){this.set_message(this.source.gen_loading());return;}var c=(new Date()).getTime();var e=false;if(this.last_search<=(c-this.source.search_limit)&&this.status==typeaheadpro.STATUS_IDLE){e=this.perform_search();}else if(this.status==typeaheadpro.STATUS_IDLE)if(!this.search_timeout)this.search_timeout=setTimeout(function(){this.search_timeout=false;if(this.status==typeaheadpro.STATUS_IDLE)this.dirty_results();}.bind(this),this.source.search_limit-(c-this.last_search));if(this.source.allow_fake_results&&this.real_suggestions&&!e){var d=typeahead_source.tokenize(this.get_value()).sort(typeahead_source._sort);var a=[];for(var b=0;b<this.real_suggestions.length;b++)if(typeahead_source.check_match(d,this.real_suggestions[b].t+' '+this.real_suggestions[b].n))a.push(this.real_suggestions[b]);if(a.length){this.found_suggestions(a,this.get_value(),true);}else{this.selectedindex=-1;this.set_message(this.source.gen_loading());}}};typeaheadpro.prototype.perform_search=function(){if(this.get_value()==this.results_text)return true;var a;if((a=this.search_cache(this.get_value()))===undefined&&!(a=this.source.search_value(this.get_value()))){this.status=typeaheadpro.STATUS_WAITING_ON_SOURCE;this.last_search=(new Date()).getTime();return false;}this.found_suggestions(a,this.get_value(),false);return true;};typeaheadpro.prototype.set_message=function(a){this.clear_render_timeouts();if(a){this.list.innerHTML='<div class=\"typeahead_message\">'+a+'<\/div>';this.reset_iframe();}else this.hide();this.recalc_scroll();};typeaheadpro.prototype.reset_iframe=function(){if(!typeaheadpro.should_use_iframe)return;typeaheadpro.iframe.style.top=this.dropdown.style.top;typeaheadpro.iframe.style.left=this.dropdown.style.left;typeaheadpro.iframe.style.width=this.dropdown.offsetWidth+'px';typeaheadpro.iframe.style.height=this.dropdown.offsetHeight+'px';typeaheadpro.iframe.style.display='';};typeaheadpro.prototype.advance_focus=function(){return this._move_focus(true);};typeaheadpro.prototype.reverse_focus=function(){return this._move_focus(false);};typeaheadpro.prototype._move_focus=function(c){var b=this.obj.form?get_all_form_inputs(this.obj.form):get_all_form_inputs();var d=[];d._insert=c?d.push:d.unshift;var e=!c;for(var a=0;a<b.length;a++)if(!c&&b[a]==this.obj){e=false;}else if(e&&b[a].type!='hidden'&&b[a].tabIndex!=-1&&b[a].offsetParent){d._insert(b[a]);}else if(b[a]==this.obj)e=true;setTimeout(function(){for(var f=0;f<this.length;f++)try{if(this[f].offsetParent){this[f].focus();setTimeout(function(){try{this.focus();}catch(e){}}.bind(this[f]),0);return;}}catch(e){}}.bind(d?d:[]),0);this.blur();this.hide();};typeaheadpro.prototype.clear_placeholder=function(){if(this.obj.className.indexOf('DOMControl_placeholder')!=-1){this.set_value('');this.set_class('');}};typeaheadpro.prototype.clear=function(){this.set_value('');this.set_class('');this.selectedindex=-1;this.enumerate=false;this.dirty_results();};typeaheadpro.prototype.hide=function(){if(this.stop_hiding)return;this.visible=false;this.dropdown.style.display='none';this.clear_render_timeouts();if(typeaheadpro.should_use_iframe)typeaheadpro.iframe.style.display='none';};typeaheadpro.prototype.show=function(){this.visible=true;if(this.focused){this.dropdown.style.top=elementY(this.anchor)+this.anchor.offsetHeight+'px';this.dropdown.style.left=elementX(this.anchor)+'px';this.dropdown.style.width=(this.anchor.offsetWidth-2)+'px';this.dropdown.style.display='';if(typeaheadpro.should_use_iframe){typeaheadpro.iframe.style.display='';this.reset_iframe();}}};typeaheadpro.prototype.toggle_icon_list=function(a){if(this.showing_icon_list){this.showing_icon_list=false;this.source.showing_icon_list=false;if(!a)this.focus();CSS.removeClass(this.typeahead_icon,'on_selected');this.want_icon_list=false;this.showing_icon_list=false;this.stop_suggestion_select=true;if(this.obj)this.dirty_results();}else{this.source.showing_icon_list=true;this.old_typeahead_value=this.obj.value;this.stop_suggestion_select=true;this.want_icon_list=true;this.dirty_results();this.focus();CSS.addClass(this.typeahead_icon,'on_selected');this.show();this.set_suggestion(-1);this.showing_icon_list=true;}setTimeout(function(){this.stop_hiding=false;}.bind(this),100);};typeaheadpro.prototype.focus=function(){this.obj.focus();};typeaheadpro.prototype.blur=function(a){if(this.obj)this.obj.blur(a);};typeaheadpro.prototype.attachEventListeners=function(){this._eventRefs=Event.listen(this.obj,{focus:this._onfocus.bind(this),blur:this._onblur.bind(this),change:this._onchange.bind(this),keyup:this._onkeyup.bind(this),keydown:this._onkeydown.bind(this),keypress:this._onkeypress.bind(this)});};typeaheadpro.prototype.removeEventListeners=function(){if(this._eventRefs)for(var a in this._eventRefs)this._eventRefs[a].remove();};typeaheadpro.kill_typeahead=function(a){if(a.typeahead){if(!this.anchor_block)a.parentNode.removeChild(a.nextSibling);a.parentNode.removeChild(a.nextSibling);if(a.typeahead.source)a.typeahead.source=a.typeahead.source.owner=null;a.removeEventListeners();a.typeahead=null;}};\nfunction typeahead_source(){}typeahead_source.prototype.cache_results=false;typeahead_source.prototype.enumerable=false;typeahead_source.prototype.allow_fake_results=false;typeahead_source.prototype.escape_results=false;typeahead_source.prototype.search_limit=10;typeahead_source.prototype.check_limit=10;typeahead_source.prototype.bootstrap=bagofholding;typeahead_source.check_match=function(f,g){g=typeahead_source.tokenize(g);for(var b=0,c=f.length;b<c;b++)if(f[b].length){var a=false;for(var d=0,e=g.length;d<e;d++)if(g[d].length>=f[b].length&&g[d].substring(0,f[b].length)==f[b]){a=true;g[d]='';break;}if(!a)return false;}return true;};typeahead_source.tokenize=function(c,a,b){return (b?c:typeahead_source.flatten_string(c)).split(a?typeahead_source.normalizer_regex_capture:typeahead_source.normalizer_regex);};typeahead_source.normalizer_regex_str='(?:(?:^| +)[\"\\'.\\\\-]+ *)|(?: *[\\'\".\\\\-]+(?: +|$)|[@_]| +)';typeahead_source.normalizer_regex=new RegExp(typeahead_source.normalizer_regex_str,'g');typeahead_source.normalizer_regex_capture=new RegExp('('+typeahead_source.normalizer_regex_str+')','g');typeahead_source.flatten_string=function(b){if(!typeahead_source.accents)typeahead_source.accents={a:\/\\u0430|\\u00e0|\\u00e1|\\u00e2|\\u00e3|\\u00e4|\\u00e5\/g,b:\/\\u0431\/g,c:\/\\u0446|\\u00e7\/g,d:\/\\u0434|\\u00f0\/g,e:\/\\u044d|\\u0435|\\u00e8|\\u00e9|\\u00ea|\\u00eb\/g,f:\/\\u0444\/g,g:\/\\u0433\/g,h:\/\\u0445\/g,i:\/\\u0438|\\u00ec|\\u00ed|\\u00ee|\\u00ef\/g,j:\/\\u0439\/g,k:\/\\u043a\/g,l:\/\\u043b\/g,m:\/\\u043c\/g,n:\/\\u043d|\\u00f1\/g,o:\/\\u043e|\\u00f8|\\u00f6|\\u00f5|\\u00f4|\\u00f3|\\u00f2\/g,p:\/\\u043f\/g,r:\/\\u0440\/g,s:\/\\u0441\/g,t:\/\\u0442\/g,u:\/\\u0443|\\u044e|\\u00fc|\\u00fb|\\u00fa|\\u00f9\/g,v:\/\\u0432\/g,y:\/\\u044b|\\u00ff|\\u00fd\/g,z:\/\\u0437\/g,ae:\/\\u00e6\/g,oe:\/\\u0153\/g,ts:\/\\u0446\/g,ch:\/\\u0447\/g,sh:\/\\u0448\/g,ya:\/\\u044f\/g};b=b.toLowerCase();for(var a in typeahead_source.accents)b=b.replace(typeahead_source.accents[a],a);return b;};typeahead_source.prototype.set_owner=function(a){this.owner=a;if(this.is_ready)this.owner.update_status(typeaheadpro.STATUS_IDLE);};typeahead_source.prototype.ready=function(){if(this.owner&&!this.is_ready){this.is_ready=true;this.owner.update_status(typeaheadpro.STATUS_IDLE);}else this.is_ready=true;};typeahead_source.highlight_found=function(g,h){var b=[];resultv=typeahead_source.tokenize(g,true,true);g=typeahead_source.tokenize(g,true);h=typeahead_source.tokenize(h);h.sort(typeahead_source._sort);for(var c=0,d=resultv.length;c<d;c++){var a=false;for(var e=0,f=h.length;e<f;e++)if(h[e]&&g[c].lastIndexOf(h[e],0)!=-1){b.push('<em>',htmlspecialchars(resultv[c].substring(0,h[e].length)),'<\/em>',htmlspecialchars(resultv[c].substring(h[e].length,resultv[c].length)));a=true;break;}if(!a)b.push(htmlspecialchars(resultv[c]));}return b.join('');};typeahead_source._sort=function(a,b){return b.length-a.length;};typeahead_source.prototype.gen_nomatch=function(){return this.text_nomatch!=null?this.text_nomatch:_tx(\"No matches found\");};typeahead_source.prototype.gen_loading=function(){return this.text_loading!=null?this.text_loading:_tx(\"Loading...\");};typeahead_source.prototype.gen_placeholder=function(){return this.text_placeholder!=null?this.text_placeholder:_tx(\"Start typing...\");};typeahead_source.prototype.gen_noinput=function(){return this.text_noinput!=null?this.text_noinput:_tx(\"Start typing...\");};typeahead_source.prototype.onselect_not_found=function(){if(typeof this.tokenizer._ontokennotfound!='undefined')this.tokenizer._ontokennotfound(this.obj.value);if(typeof this.tokenizer.onselect!='undefined')return this.tokenizer.onselect();};typeahead_source.prototype.gen_html=function(d,a){var e=d.t||d;var b=['<div>',typeahead_source.highlight_found(e,a),'<\/div>'];if(d.s){var c=(this.escape_results?htmlspecialchars(d.s):d.s);b.push('<div class=\"sub_result\"><small>',c,'<\/small><\/div>');}return b.join('');};\nvar Toggler=function(){function a(f){copy_properties(this,{active:null,callback:null,clicked:null,togglers:{}});f=f||{};this.setSticky(f.sticky);this.setTabToHide(f.tabToHide);e.push(this);}var e=[],d,b;function c(f){if(f instanceof a)return f;return d=d||new a();}a.prototype={show:function(g,f){var h=c(this);h.active=g;CSS.addClass(g,'openToggler');if(h.tabToHide){DOM.appendContent(g,h.getToggler('next'));DOM.prependContent(g,h.getToggler('prev'));}if(f){f(true,g);h.callback=f;}},hide:function(f){var g=c(this);if(f){var h=e.length;while(h--)if(!e[h].sticky||e[h]===g)e[h]._hide();}else g._hide();},_hide:function(h){var i=c(this),f=i.active,g=i.callback;if(f)CSS.removeClass(f,'openToggler');if(i.clicked)i.clicked[h?'focus':'blur']();if(i.tabToHide)for(var j in i.togglers){j=i.togglers[j];if(j&&j.parentNode)j.parentNode.removeChild(j);}i.active=i.callback=i.clicked=null;if(g)g(false,f);},toggle:function(h,g){var i=c(this),f=h.parentNode,j=i.active;i.hide(true);i.clicked=h;if(CSS.hasClass(f,'openToggler')||(i!==d&&f!==j))i.show(f,g);b&&b.remove();b=Event.listen(document.documentElement,'click',function(event){if(i.sticky)return;if(f!==j){var k=event.getTarget();if(DOM.contains(h,k)){i.show(f,g);}else if(!DOM.contains(f,k)){i.hide(true);b.remove();}}},Event.Priority.URGENT);},getActive:function(){return c(this).active;},getClicked:function(){return c(this).clicked;},getToggler:function(g){var f=c(this);if(!f.togglers[g])f.togglers[g]=$N('button',{className:'hideToggler',onfocus:f._hide.bind(f,true)});return f.togglers[g];},setSticky:function(g){var f=c(this);f.sticky=!!g;if(g){f._pt&&Arbiter.unsubscribe(f._pt);}else f._pt=Arbiter.subscribe(\"page_transition\",f.hide.bind(f));},setTabToHide:function(f){c(this).tabToHide=f!==false;}};copy_properties(a,a.prototype);return a;}();\nfunction collect_data_attrib(d,g){var f={};var c='data-'+g;while(d&&!DOM.isNode(d,'body')){var b=d.getAttribute(c);if(b){var a=JSON.decode(b);for(var e in a)if(f[e]==undefined)f[e]=a[e];}d=d.parentNode;}return f;}\nvar ft={NF_SOURCE_MINIFEED:9,NF_SOURCE_STREAM:10,NF_SOURCE_HIGHLIGHTS:11,NF_EVENT_SEE_MORE:28,NF_EVENT_HOVERCARD_IMPRESSION:39,enableFeedTracking:function(){ft.feedTrackingIsEnabled=true;onunloadRegister(function(){ft.feedTrackingIsEnabled=false;});},logElem:function(a,c){if(!ft.feedTrackingIsEnabled)return;var b=collect_data_attrib(a,'ft');if(count(b)){b.dest=a.href;ft.logData(b,c);}},logData:function(a,b){var c={};copy_properties(c,a);if(b)copy_properties(c,b);new AsyncSignal('\/ajax\/f2.php',{link_data:JSON.encode(c)}).send();}};onloadRegister(function(){window.LinkController&&LinkController.registerFallbackHandler(function(a){ft.logElem(a);},ElementController.ALL,true);});\nfunction InstrumentedLogger(a){if(this===window)return new InstrumentedLogger(a);if(InstrumentedLogger._instances[a])return InstrumentedLogger._instances[a];copy_properties(this,{id:a,_phases:{}});return InstrumentedLogger._instances[a]=this;}copy_properties(InstrumentedLogger,{_instances:{}});copy_properties(InstrumentedLogger.prototype,{beginPhase:function(a){if(this._phases[a]&&this._phases[a].start)this.endPhase(a);if(typeof(this._phases[a])=='undefined')this._phases[a]={start:0,count:0,duration:0};this._phases[a].start=new Date().getTime();return this;},endPhase:function(a){var b=this._phases[a];if(b&&b.start){b.count++;b.duration+=new Date().getTime()-b.start;b.start=null;}return this;},dumpAndReset:function(){this.dump();return this.reset();},dump:function(){for(var b in this._phases){var c=this._phases[b];var a=(this.id?this.id+'::':'')+b;}return this;},get:function(a){if(this._phases[a])return this._phases[a].duration\/this._phases[a].count;return 0;},reset:function(){this._phases={};return this;}});InstrumentedLogger.prototype.b=InstrumentedLogger.prototype.beginPhase;InstrumentedLogger.prototype.e=InstrumentedLogger.prototype.endPhase;InstrumentedLogger.prototype.d=InstrumentedLogger.prototype.dump;InstrumentedLogger.prototype.D=InstrumentedLogger.prototype.dumpAndReset;InstrumentedLogger.prototype.r=InstrumentedLogger.prototype.reset;var IL=InstrumentedLogger;\nfunction UntrustedLink(a,d,b,c){this.dom=a;this.url=a.href;this.hash=d;this.func_get_params=c||function(){return {};};Event.listen(this.dom,'click',this.onclick.bind(this));Event.listen(this.dom,'mousedown',this.onmousedown.bind(this));Event.listen(this.dom,'mouseup',this.onmouseup.bind(this));Event.listen(this.dom,'mouseout',this.onmouseout.bind(this));this.onmousedown($E(b));}UntrustedLink.bootstrap=function(a,d,b,c){if(a.__untrusted)return;a.__untrusted=true;new UntrustedLink(a,d,b,c);};UntrustedLink.prototype.getRewrittenURI=function(){var a=copy_properties({u:this.url,h:this.hash},this.func_get_params(this.dom));return new URI('\/l.php').setQueryData(a).setSubdomain('www');};UntrustedLink.prototype.onclick=function(){(function(){this.dom.href=this.url;}).bind(this).defer(100);this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmousedown=function(a){if(a.button==2)this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmouseup=function(){this.dom.href=this.getRewrittenURI();};UntrustedLink.prototype.onmouseout=function(){this.dom.href=this.url;};\nfunction Rect(e,d,a,c,b){if(this===window){if(e instanceof Rect)return e;if(e instanceof Vector2)return new Rect(e.y,e.x,e.y,e.x,e.domain);return Rect.getElementBounds($(e));}copy_properties(this,{t:e,r:d,b:a,l:c,domain:b||'pure'});}copy_properties(Rect.prototype,{w:function(){return this.r-this.l;},h:function(){return this.b-this.t;},area:function(){return this.w()*this.h();},toString:function(){return '(('+this.l+', '+this.t+'), ('+this.r+', '+this.b+'))';},intersects:function(b){b=Rect(b).convertTo(this.domain);var a=this;if(a.l>b.r||b.l>a.r||a.t>b.b||b.t>a.b)return false;return true;},clipTo:function(a){a=a.convertTo(this.domain);if(!this.intersects(a))return null;return new Rect(Math.max(this.t,a.t),Math.min(this.r,a.r),Math.min(this.b,a.b),Math.max(this.l,a.l),this.domain);},contains:function(b){b=Rect(b).convertTo(this.domain);var a=this;if(b instanceof Vector2){return (a.l<=b.x&&a.r>=b.x&&a.t<=b.y&&a.b>=b.y);}else return (a.l<=b.l&&a.r>=a.r&&a.t<=b.t&&a.b>=b.b);},canContain:function(a){a=Rect(a).convertTo(this.domain);return (a.h()<=this.h())&&(a.w()<=this.w());},forceBelow:function(b,a){a=a||0;b=Rect(b).convertTo(this.domain);if(b.b>this.t)return this.add(0,(b.b-this.t)+a);return this;},add:function(c,d){if(arguments.length==1){if(c.domain!='pure')c=c.convertTo(this.domain);return this.add(c.x,c.y);}var a=parseFloat(c);var b=parseFloat(d);return new Rect(this.t+b,this.r+a,this.b+b,this.l+a,this.domain);},sub:function(a,b){if(arguments.length==1){return this.add(a.mul(-1));}else return this.add(-a,-b);},expand:function(a,b){return new Rect(this.t,this.r+a,this.b+b,this.l,this.domain);},scale:function(a,b){b=b||a;return new Rect(this.t,this.l+(this.w()*a),this.t+(this.h()*b),this.l,this.domain);},setDimensions:function(a,b){return new Rect(this.t,this.l+a,this.t+b,this.l,this.domain);},setPosition:function(a,b){return new Rect(a,this.w(),this.h(),b,this.domain);},boundWithin:function(a){var b=0,c=0;if(this.l<a.l){b=a.l-this.l;}else if(this.r>a.r)b=a.r-this.r;if(this.t<a.t){c=a.t-this.t;}else if(this.b>a.b)c=a.b-this.b;return this.add(b,c);},setElementBounds:function(a){this.getPositionVector().setElementPosition(a);this.getDimensionVector().setElementDimensions(a);return this;},getPositionVector:function(){return new Vector2(this.l,this.t,this.domain);},getDimensionVector:function(){return new Vector2(this.w(),this.h(),'pure');},convertTo:function(a){if(this.domain==a)return this;if(a=='pure')return new Rect(this.t,this.r,this.b,this.l,'pure');if(this.domain=='pure')return new Rect(0,0,0,0);var b=new Vector2(this.l,this.t,this.domain).convertTo(a);return new Rect(b.y,b.x+this.w(),b.y+this.h(),b.x,a);},constrict:function(a,b){if(typeof(b)=='undefined')b=a;a=a||0;return new Rect(this.t+b,this.r-a,this.b-b,this.l+a,this.domain);},expandX:function(){return new Rect(this.t,Number.POSITIVE_INFINITY,this.b,Number.NEGATIVE_INFINITY);},expandY:function(){return new Rect(number.NEGATIVE_INFINITY,this.r,Number.POSITIVE_INFINITY,this.l);},drawBox:function(a){var b=$N('div',{style:{position:'absolute',border:'2px solid '+(a||'red'),zIndex:'10000'}});this.setElementBounds(b);document.body.appendChild(b);}});copy_properties(Rect,{newFromVectors:function(b,a){return new Rect(b.y,b.x+a.x,b.y+a.y,b.x,b.domain);},getElementBounds:function(a){return Rect.newFromVectors(Vector2.getElementPosition(a),Vector2.getElementDimensions(a));},getViewportBounds:function(){return Rect.newFromVectors(Vector2.getScrollPosition(),Vector2.getViewportDimensions());},getDocumentBounds:function(){return Rect.newFromVectors(new Vector2(0,0,'document'),Vector2.getDocumentDimensions());}});\nfunction Collection(e,d){if(!e.__collection__){var a=new Function();for(var c in e.prototype)a.prototype[c]=Collection._call.bind(null,c);e.__collection__=a;}var b=new e.__collection__();b._elements=d;return b;}Collection._call=function(b){var a=Array.prototype.slice.call(arguments,1);this._elements.each(function(c){c[b].apply(c,a);});return this;};\nfunction Scroller(a){this.canvas=a;this.scrollZone=50;this.velocity=100;this.coefficient=1;}Scroller.findScrollParent=function(a){var b;a=a.parentNode;while(a){if(a.scrollHeight!=a.offsetTop){b=CSS.getStyle(a,'overflowY');if(b=='scroll'||b=='auto')return a;}a=a.parentNode;}return document.body;};Scroller.prototype.activate=function(){this.activate=bagofholding;this.event=Event.listen(document,'mousemove',this._onmousemove.bind(this));this.interval=this._intervalHandler.bind(this).recur(50);this.cursor=null;};Scroller.prototype.deactivate=function(){delete this.activate;this.event&&this.event.remove();this.event=null;clearInterval(this.interval);};Scroller.prototype._onmousemove=function(event){this.cursor=new Vector2.getEventPosition(event);};Scroller.prototype._intervalHandler=function(){if(!this.cursor)return;var c=this.canvas==document.body?Rect.getViewportBounds():Rect(this.canvas);var a=new Rect(this.cursor.y-c.t,c.r-this.cursor.x,c.b-this.cursor.y,this.cursor.x-c.l);var b=new Vector2(0,0);if(a.t<a.b&&a.t<this.scrollZone){b.y=-this.scrollZone+a.t;}else if(a.b<this.scrollZone)b.y=this.scrollZone-a.b;b.y=this._doMath(b.y);if(a.l<a.r&&a.l<this.scrollZone){b.x=-this.scrollZone+a.l;}else if(a.r<this.scrollZone)b.x=this.scrollZone-a.r;b.x=this._doMath(b.x);if(b.x||b.y){b.scrollElementBy(this.canvas);if(document.body==this.canvas)this.cursor=this.cursor.add(b);Arbiter.inform('scroller\/scroll',this.cursor);}};Scroller.prototype._doMath=function(a){return Math.floor(Math.pow((a>=0?Math.min(a,this.scrollZone):Math.max(a,-this.scrollZone))\/this.scrollZone*this.velocity,this.coefficient));};\nvar Drag={};Drag.currentDraggable=null;Drag.grab=function(a){if(Drag.currentDraggable)Drag._onmouseup();a.lastDragOver=null;Drag.attachDragEvents();Drag.currentDraggable=a;};Drag.attachDragEvents=function(){document.onselectstart=function(){document.onselectstart=null;return false;};if(Drag.dragEventsAttached)return;Drag.dragEventsAttached=true;Arbiter.subscribe('scroller\/scroll',Drag._onmousemove);Event.listen(document,{mousemove:Drag._onmousemove,mouseup:Drag._onmouseup});};Drag.droppables={};Drag.addDroppable=function(b,a){(Drag.droppables[b]=Drag.droppables[b]||[]).push(a);};Drag.removeDroppable=function(b,a){Drag.droppables[b]=Drag.droppables[b].filter(function(c){return c!=a;});};Drag._onmousemove=function(event,c){if(!Drag.currentDraggable)return;var d=c||Vector2.getEventPosition(event),b=Drag.currentDraggable,e=Drag.droppables[b.namespace];if(b.namespace&&b.active&&e){var j={};e.each(function(k){j[k.zIndex]=k.zIndex;});var i=[];for(var f in j)i.push(j[f]);i.sort();var g=b.lastDragOver,a=null;for(var h=i.length;h>=0;h--)if(g&&g.dom!=null&&g.zIndex==i[h]&&g.pointInside(d)){a=g;break;}else for(var f=0;f<e.length;f++){if(i[h]!=e[f].zIndex)continue;if(g!=e[f]&&b.dom!=e[f].dom&&e[f].pointInside(d)){a=e[f];h=-1;break;}}if(a&&a!=g)a.ondragover(b);if(a)a.ondragmove(b,d.sub(Vector2.getElementPosition(a.dom)));b.lastDragOver=a;}Drag.currentDraggable._onmousemove(d);};Drag._onmouseup=function(a){document.onselectstart=null;if(Drag.currentDraggable){Drag.currentDraggable._ondrop();Drag.currentDraggable=null;}};function Draggable(b){if(!b)throw new Error('Element should be a DOM node');if(this==window){if(b instanceof Array){var a=[];b.each(function(c){a.push(new Draggable(c));});return new Collection(Draggable,a);}else return new Draggable(b);}else{this.data={};this.handles=[];this.dom=b;this.boundingBox=null;this.addHandle(this.dom);}}Draggable.prototype.destroy=function(){this.handles.each(function(a){this.removeHandle(a.obj);}.bind(this));this.data=this.dom=null;};Draggable.prototype._onclick=function(event){if(this.active)return Event.kill(event);};Draggable.prototype._ongrab=function(a){this.ongrab();if(!this.scroller)this.scroller=new Scroller(Scroller.findScrollParent(this.dom));this.scroller.activate();if(this.active){if(!this.oldPosition)this.oldPosition=this.dom.style.position;this.dom.style.position=this.absolute?'absolute':'relative';a.sub(this.cursorPositionVector).setElementPosition(this.dom);}};Draggable.prototype._onmousedown=function(event){var a=$E(event).getTarget();if(DOM.isNode(a,['input','select','textarea','object','embed']))return true;var b=Vector2.getEventPosition(event);this.draggableInitialVector=Vector2.getElementPosition(this.dom);this.cursorPositionVector=b.sub(this.draggableInitialVector);Drag.grab(this,event);if(this.gutter){this.cursorInitialVector=b;}else{this._setActive(true);this._ongrab(b);}return Event.kill(event);};Draggable.prototype._onmousemove=function(d){if(!this.active)if(d.distanceTo(this.cursorInitialVector)>=this.gutter){this._setActive(true);this._ongrab(d);}if(this.active){var c=Vector2.getElementPosition(this.dom).sub(new Vector2(parseInt(this.dom.style.left?this.dom.style.left:CSS.getStyle(this.dom,'left'),10)||0,parseInt(this.dom.style.top?this.dom.style.top:CSS.getStyle(this.dom,'top'),10)||0));var e=d.sub(c).sub(this.cursorPositionVector);if(this.boundingBox){var a=Rect.newFromVectors(e,Vector2.getElementDimensions(this.dom));a=a.boundWithin(this.boundingBox);e=a.getPositionVector(a);if(this.boundingBox.w()==0){var b=new Vector2(this.draggableInitialVector.x,e.y,'document');}else if(this.boundingBox.h()==0){var b=new Vector2(e.x,this.draggableInitialVector.y,'document');}else var b=e;}else var b=e;b.setElementPosition(this.dom);this.ondrag(d);}};Draggable.prototype._ondrop=function(){this.scroller&&this.scroller.deactivate();if(this.active){(function(){this._setActive(false);}).bind(this).defer();this.ondrop();if(this.lastDragOver)this.lastDragOver.ondrop(this);}};Draggable.prototype.killDrag=function(){this._setActive(false);Drag._onmouseup();};Draggable.prototype.setBoundingBox=function(a){this.boundingBox=a;return this;};Draggable.prototype.resetPosition=function(){this.dom.style.position=this.oldPosition;this.oldPosition=null;this.dom.style.left='';this.dom.style.top='';return this;};Draggable.prototype.setUseAbsolute=function(a){this.absolute=a;return this;};Draggable.prototype.ondrag=bagofholding;Draggable.prototype.setDragHandler=function(a){this.ondrag=a;return this;};Draggable.prototype.ongrab=bagofholding;Draggable.prototype.setGrabHandler=function(a){this.ongrab=a;return this;};Draggable.prototype.ondrop=bagofholding;Draggable.prototype.setDropHandler=function(a){this.ondrop=a;return this;};Draggable.prototype.gutter=0;Draggable.prototype.setGutter=function(a){this.gutter=a;return this;};Draggable.prototype.setNamespace=function(a){this.namespace=a;return this;};Draggable.prototype.handles=null;Draggable.prototype.addHandle=function(a){if(this.handles.length==1&&this.handles[0].obj==this.dom)this.removeHandle(this.dom);this.handles.push({obj:a,evt:[Event.listen(a,'mousedown',this._onmousedown.bind(this)),Event.listen(a,'click',this._onclick.bind(this)),Event.listen(a,'drag',Event.kill),Event.listen(a,'selectstart',Event.kill)]});return this;};Draggable.prototype.removeHandle=function(a){this.handles=this.handles.filter(function(b){if(b.obj!=a){return true;}else{b.evt.each(function(c){c.remove();});return false;}});};Draggable.prototype.getDOM=function(){return this.dom;};Draggable.prototype.setKey=function(a,b){this.data[a]=b;return this;};Draggable.prototype.getKey=function(a){return this.data[a];};Draggable.prototype._setActive=function(b){this.dom.activeDrag=this.active=b;for(var a=0;a<this.handles.length;a++)this.handles[a].obj.activeDrag=b;};function Droppable(b){if(!b)throw new Error('Element should be a DOM node');if(this==window){if(b instanceof Array){var a=[];b.each(function(c){a.push(new Droppable(c));});return new Collection(Droppable,a);}else return new Droppable(b);}else{this.data={};this.dom=b;this.namespace=null;}}Droppable.prototype.destroy=function(){if(this.namespace)Drag.removeDroppable(this.namespace,this);this.data=this.dom=null;};Droppable.prototype.setNamespace=function(a){if(this.namespace)Drag.removeDroppable(a,this);this.namespace=a;Drag.addDroppable(a,this);return this;};Droppable.prototype.zIndex=0;Droppable.prototype.setZIndex=function(a){this.zIndex=a;return this;};Droppable.prototype.pointInside=function(b){var a=Vector2.getElementPosition(this.dom);return a.x<=b.x&&this.dom.offsetWidth+a.x>b.x&&a.y<=b.y&&this.dom.offsetHeight+a.y>b.y;};Droppable.prototype.ondragover=bagofholding;Droppable.prototype.setDragOverHandler=function(a){this.ondragover=a;return this;};Droppable.prototype.ondragmove=bagofholding;Droppable.prototype.setDragMoveHandler=function(a){this.ondragmove=a;return this;};Droppable.prototype.ondrop=bagofholding;Droppable.prototype.setDropHandler=function(a){this.ondrop=a;return this;};Droppable.prototype.getDOM=Draggable.prototype.getDOM;Droppable.prototype.setKey=Draggable.prototype.setKey;Droppable.prototype.getKey=Draggable.prototype.getKey;\nfunction SortableGroup(){this.namespace='sortable'+(++SortableGroup.instanceCount);this.draggables={};this.droppables={};this.sortables={};this.linkedGroups=[];this.linkedGroups.onlinkjump=bagofholding;this.rootNode=null;this.boundingBox=null;this.neverEmpty=false;this.hasEmptyMessage=false;this.isDroppable=true;this.anchor=null;}SortableGroup.instanceCount=0;SortableGroup.prototype.gutter=15;SortableGroup.prototype.setBoundingBox=function(a){this.boundingBox=a;for(var b in this.draggables)this.draggables[b].setBoundingBox(this.boundingBox);return this;};SortableGroup.prototype.setDroppable=function(a){this.isDroppable=a;return this;};SortableGroup.prototype._initializeAdded=function(a,b){if(this.rootNode===null){this.rootNode=b.parentNode;if(!this.linkedGroups.placeholder){this.linkedGroups.placeholder=this.placeholder=$N(b.tagName,{className:'dragPlaceholder',style:{padding:'0px'}});}else this.placeholder=this.linkedGroups.placeholder;}else if(this.rootNode!=b.parentNode)throw new Error('All sortables of a collection must share the same parentNode');if(a in this.draggables)throw new Error('All sortables must have a unique key');};SortableGroup.prototype.addSortable=function(b,c,a){this._initializeAdded(b,c);this.sortables[b]=c;this.draggables[b]=(new Draggable(c)).setNamespace(this.namespace).setGutter(this.gutter).setUseAbsolute(true).setGrabHandler(this.grabHandler.bind(this,b)).setDropHandler(this.dropHandler.bind(this,b)).setKey('key',b).setBoundingBox(this.boundingBox);if(a)this.draggables[b].addHandle(a);this.droppables[b]=(new Droppable(c)).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(null,this,b));return this;};SortableGroup.prototype.addEmptyMessage=function(b,c){var a='placeholder';if(b.parentNode!=c)c.appendContent(b);this._initializeAdded(a,b);this.hasEmptyMessage=true;this.sortables[a]=b;this.droppables[a]=(new Droppable(b)).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(null,this,a));return this;};SortableGroup.prototype.setNeverEmpty=function(a){this.neverEmpty=a;};SortableGroup.prototype.link=function(c){c.linkedGroups=this.linkedGroups;if(!this.linkedGroups.length)this.linkedGroups.push(this);this.linkedGroups.push(c);for(var a=0;a<this.linkedGroups.length;a++)if(this.linkedGroups[a].namespace!=this.namespace){this.linkedGroups[a].namespace=this.namespace;for(var b in this.linkedGroups[a].droppables){this.linkedGroups[a].droppables[b].setNamespace(this.namespace);this.linkedGroups[a].draggables[b].setNamespace(this.namespace);}}return this;};SortableGroup.prototype.getOrder=function(){if(!this.rootNode)return [];var d=[],a=this.rootNode.childNodes;for(var b=0;b<a.length;b++)for(var c in this.sortables)if(this.sortables[c]==a[b]){d.push(c);break;}return d;};SortableGroup.prototype.migrateLinkedSortable=function(b){for(var a=0;a<this.linkedGroups.length;a++)if(b in this.linkedGroups[a].draggables){this.sortables[b]=this.linkedGroups[a].sortables[b];this.draggables[b]=this.linkedGroups[a].draggables[b];this.draggables[b].setGrabHandler(this.grabHandler.bind(this,b)).setDropHandler(this.dropHandler.bind(this,b));this.droppables[b]=this.linkedGroups[a].droppables[b];this.droppables[b].setDragOverHandler(this._dragOverHandlerShim.bind(null,this,b));delete this.linkedGroups[a].sortables[b];delete this.linkedGroups[a].draggables[b];delete this.linkedGroups[a].droppables[b];return true;}return false;};SortableGroup.prototype.setLinkJumpHandler=function(a){this.linkedGroups.onlinkjump=a;return this;};SortableGroup.prototype.onorderchange=bagofholding;SortableGroup.prototype.setOrderChangeHandler=function(a){this.onorderchange=a;return this;};SortableGroup.prototype.onbeforegrabcallback=bagofholding;SortableGroup.prototype.setBeforeGrabCallback=function(a){this.onbeforegrabcallback=a;return this;};SortableGroup.prototype.ongrabcallback=bagofholding;SortableGroup.prototype.setGrabCallback=function(a){this.ongrabcallback=a;return this;};SortableGroup.prototype._checkLastRemaining=function(a){var b=this.hasEmptyMessage?2:1;return this.neverEmpty&&this.rootNode.childNodes.length==b;};SortableGroup.prototype.grabHandler=function(a){if(this._checkLastRemaining()){this.draggables[a].killDrag();return;}this.onbeforegrabcallback(a);CSS.setClass(this.placeholder,this.sortables[a].className);CSS.addClass(this.placeholder,'droppable_placeholder');CSS.addClass(this.sortables[a],'drag');Vector2.getElementDimensions(this.sortables[a]).setElementDimensions(this.placeholder);this.rootNode.insertBefore(this.placeholder,this.sortables[a]);this.ongrabcallback(a);if(!this.isDroppable){var b=this.sortables[a];this.anchor=b.nextSibling;if(!this.anchor){this.anchor=$N('div');b.parentNode.appendChild(this.anchor);}}};SortableGroup.prototype.ondropcallback=bagofholding;SortableGroup.prototype.setDropCallback=function(a){this.ondropcallback=a;return this;};SortableGroup.prototype.dropHandler=function(a){if(this._checkLastRemaining()){this.draggables[a].resetPosition();return;}CSS.removeClass(this.sortables[a],'drag');this.draggables[a].resetPosition();this.rootNode.insertBefore(this.sortables[a],this.placeholder);this.rootNode.removeChild(this.placeholder);for(var b=0;b<this.linkedGroups.length;b++)if(this.linkedGroups[b].anchor)delete this.linkedGroups[b].anchor;this.ondropcallback(a,this.sortables[a]);this.onorderchange();};SortableGroup.prototype._dragOverHandlerShim=function(c,b,a){c.dragOverHandler(b,a.getKey('key'));};SortableGroup.prototype.dragOverHandler=function(f,d){if(!this.isDroppable&&!this.anchor)return;var h=false;if(!(d in this.draggables)){if(!this.migrateLinkedSortable(d))throw new Error('Draggable dropped onto a foreign droppable!');h=true;}var a=true,b=this.rootNode.childNodes,c=this.sortables[d],e=this.sortables[f];if(!this.anchor){var i=b.length;for(var g=0;g<i;g++)if(b[g]==e){break;}else if(b[g]==c){a=false;break;}}else e=this.anchor;if(a||this.anchor){this.rootNode.insertBefore(this.placeholder,e);}else this.rootNode.insertBefore(this.placeholder,e.nextSibling);this.rootNode.insertBefore(c,this.placeholder);this.ondragover(c,e);if(h)this.linkedGroups.onlinkjump.call(this,d);};SortableGroup.prototype.ondragover=bagofholding;SortableGroup.prototype.setDragOverCallback=function(a){this.ondragover=a;return this;};SortableGroup.prototype.destroy=function(){for(var b in this.droppables)this.droppables[b].destroy();for(var b in this.draggables)this.draggables[b].destroy();this.droppables=this.draggables=this.rootNode=null;this.linkedGroups.remove(this);for(var a=0;a<this.linkedGroups.length;a++)this.linkedGroups[a].linkedGroups=this.linkedGroups;};SortableGroup.prototype.removeSortable=function(a){if(a in this.sortables){this.draggables[a].destroy();this.droppables[a].destroy();delete this.draggables[a];delete this.droppables[a];delete this.sortables[a];}};SortableGroup.prototype.keyExists=function(a){return this.sortables[a];};\nfunction Template(a){copy_properties(this,{_templateSource:a});}copy_properties(Template,{_operatorRepeat:function(d,a){var f='';var c=d.match(\/([^:]*):(.*)\/);if(!(!c))if(!(!TemplateRegistry.hasTemplate(c[2])))if(a[c[1]]){var e=TemplateRegistry.getTemplate(c[2]);var b=arrayize(a[c[1]]);f+=b.map(function(h,g){return h.render(g);}.curry(e)).join(' ');}return f;}});copy_properties(Template.prototype,{getSource:function(){return this._templateSource;},render:function(b){var a=function(d,c,f,e){switch(f){case 'H':return d[e]||'';case 'R':return Template._operatorRepeat(e,d);default:if(!d[e])return '';return window.HTML&&d[e] instanceof HTML?d[e].getContent():htmlize(d[e]);}return d[e]?translator(d[e]):'';}.curry(b||{});return this._templateSource.replace(\/\\$(H|R)?{([^\\}]*)\\}\/g,a);}});var TemplateRegistry={_storage:{},registerTemplate:function(a,b){if(typeof(b)==\"string\")b=new Template(b);this._storage[a]=b;return this;},unregisterTemplate:function(a){delete this._storage[a];},hasTemplate:function(a){return a in this._storage;},getTemplate:function(a){if(this.hasTemplate(a))return this._storage[a];return null;},registerServerSideTemplate:function(d,b,e,c){b=b||bagofholding;e=!!e;c=!!c;if(this.hasTemplate(d)){b();return this;}var a=new AsyncRequest(d).setReadOnly(true).setMethod('GET').setOption('asynchronous',!e).setOption('suppressEvaluation',!c);if(!e)a.setErrorHandler(this._registerErrorHandler.bind(this,d)).setHandler(this._registerHandler.bind(this,d,c,b));a.send();if(e){var f=this._stripHasteComments(a.transport.responseText);this.registerTemplate(d,new Template(f));b();}return this;},_registerErrorHandler:function(a,b){},_registerHandler:function(c,b,a,e){var d=e.getPayload();var f=null;if(b){if(d.template)f=d.template;}else f=this._stripHasteComments(d.responseText);if(f){this.registerTemplate(c,f);a();}},_stripHasteComments:function(a){return a.replace(\/^\\s*\\\/\\*\\*?(.|\\n)*\\*\\\/\/m,'');},_onRegisterTemplate:function(b,a){if(b=='template\/registerTemplate'){if(!(!a||!a.name||!a.template))this.registerTemplate(a.name,a.template);return false;}return true;}};Arbiter.subscribe('template\/registerTemplate',TemplateRegistry._onRegisterTemplate.bind(TemplateRegistry),Arbiter.SUBSCRIBE_ALL);\nfunction TemplateObject(c,a){a=a||{};if(!(c instanceof Template))if(TemplateRegistry.hasTemplate(c)){c=TemplateRegistry.getTemplate(c);}else if(c instanceof URI){TemplateRegistry.registerServerSideTemplate(c.toString(),null,true);c=TemplateRegistry.getTemplate(c);}if(c==null)throw new Error(\"Template could not be found\");var b=c.render(a);copy_properties(this,{_nodes:HTML(b).getNodes(),_template:c,_rendered:b});TemplateObject.bindNodes(this._nodes,this);}copy_properties(TemplateObject,{bindNodes:function(f,g){var a=[];for(var c=0;c<f.length;c++)if(f[c].nodeType==DOM.NODE_TYPES.ELEMENT){a.push(f[c]);var e=f[c].getElementsByTagName('*');a=a.concat(to_array(e));}for(var c=0;c<a.length;c++){var b=a[c].getAttribute('bindPoint');var d=a[c].getAttribute('listen');if(b)if(hasArrayNature(g[b])){g[b].push(a[c]);}else g[b]=a[c];if(d)d.replace(\/(\\w+) *: *(\\w+)\/g,function(k,j,h,i){if(typeof(this[i])==\"function\"){Event.listen(k,h,bind(this,this[i]));}else Event.listen(k,h,bind(this,TemplateObject._eventWrapper,i));}.bind(g,a[c]));}},_eventWrapper:function(a,event){if(typeof(this[a])==\"function\"){return this[a](event);}else return true;}});copy_properties(TemplateObject.prototype,{getNodes:function(){return this._nodes;},getRendered:function(){return this._rendered;}});\nfunction UrlDetector(a){this.element=a;this.lastCharCount=0;this.lastScrapedURL=null;this.detectionInterval=null;this.suppressDetection=bagofholding;Event.listen(a,'focus',this.startDetectionInterval.bind(this));Event.listen(a,'blur',this.stopDetectionInterval.bind(this));var b=DOM.isNode(this.element,['input','textarea']);copy_properties(this,{getText:b?function(){return this.element.value;}:function(){return DOM.getText(this.element);},setText:b?function(c){this.element.value=c;}:function(c){DOM.setContent(this.element,c);}});}UrlDetector.mixin('Arbiter',{getText:bagofholding,setText:bagofholding,setSuppressDetectionCheck:function(a){this.suppressDetection=a;},startDetectionInterval:function(){if(this.detectionInterval||this.suppressDetection())return;this.detectionInterval=setInterval(this.detectionIntervalFire.bind(this),250);},stopDetectionInterval:function(){this.detectionInterval=clearInterval(this.detectionInterval);},detectionIntervalFire:function(){if(this.suppressDetection())return;var a=this.getText().length;if((a-this.lastCharCount)>5||(this.lastCharCount==0&&a>1))var b=true;this.lastCharCount=a;var c=this.detectUrl(b);if(c)this.inform('urlDetected',c);},detectUrl:function(d){var g='',f=this.getText(),e=-1,a=-1;if(d){g=f.match(\/(?:^|[^a-z])(www\\.\\S+)\/mi);if(g){e=f.indexOf(g[1]);a=e+g[1].length;g=\"http:\/\/\"+g[1];}else{var c=f.match(\/(http|fb):\\\/\\\/\\S*\/i);if(c){g=c[0];e=f.indexOf(c[0]);a=e+c[0].length;}}}else{g=f.match(\/(?:^|[^a-z])(www\\.\\S+[\\s|\\)|\\!])\/mi);if(g){e=f.indexOf(g[1]);a=e+g[1].length;g=\"http:\/\/\"+g[1];}else{var c=f.match(\/(http|fb):\\\/\\\/\\S*[\\s|\\)|\\!]\/i);if(c){g=c[0];e=f.indexOf(c[0]);a=e+c[0].length;}}}if(g){g=g.replace(\/[\\s|\\)]\/g,'');while(true){var b=g.charAt(g.length-1);if(!b.match(\/[,|.|\\!]\/))break;g=g.substr(0,g.length-1);}if(g!=this.lastScrapedURL){this.lastScrapedURL=g;if(g.search('fb:')==0)this.setText(f.substr(0,e)+f.substr(a));}else g='';}return g;}});\nvar PrivacyBaseValue={FACEBOOK_EMPLOYEES:112,CUSTOM:111,OPEN:100,EVERYONE:80,NETWORKS_FRIENDS_OF_FRIENDS:60,NETWORKS_FRIENDS:55,FRIENDS_OF_FRIENDS:50,ALL_FRIENDS:40,SELF:10,NOBODY:0};var PrivacyFriendsValue={EVERYONE:80,NETWORKS_FRIENDS:55,FRIENDS_OF_FRIENDS:50,ALL_FRIENDS:40,SOME_FRIENDS:30,SELF:10,NO_FRIENDS:0};var PrivacySpecialPreset={ONLY_CORP_NETWORK:200,COLLEGE_NETWORK_FRIENDS_OF_FRIENDS:201,COLLEGE_NETWORK_FRIENDS:202};var PrivacyNetworkTypes={TYPE_COLLEGE:1,TYPE_HS:2,TYPE_CORP:3,TYPE_GEO:4,TYPE_TEST:50};var PrivacyNetworksAll=1;copy_properties(PrivacyBaseValue,PrivacySpecialPreset);function PrivacyModel(){this.value=PrivacyBaseValue.ALL_FRIENDS;this.friends=PrivacyFriendsValue.ALL_FRIENDS;this.networks=[];this.lists=[];this.lists_x=[];this.list_anon=0;this.ids_anon=[];this.list_x_anon=0;this.ids_x_anon=[];this.tdata={};return this;}copy_properties(PrivacyModel.prototype,{init:function(j,a,h,f,g,d,b,e,c,i){this.value=j;this.friends=a;this.networks=h.clone();this.lists=f.clone();this.lists_x=g.clone();this.list_anon=d;this.ids_anon=b.clone();this.list_x_anon=e;this.ids_x_anon=c.clone();i=i||{};copy_properties(this.tdata,i);},clone:function(){var a=new PrivacyModel();a.init(this.value,this.friends,this.networks,this.lists,this.lists_x,this.list_anon,this.ids_anon,this.list_x_anon,this.ids_x_anon,this.tdata);return a;},getData:function(){var b=['value','friends','networks','lists','lists_x','list_anon','ids_anon','list_x_anon','ids_x_anon'];var d={};for(var c=0;c<b.length;++c){var a=b[c];d[a]=this[a];}return d;}});\nfunction BasePrivacyWidget(a,c,b){this._controllerId=a;this._root=$(a);this._menu=null;this._selectList=null;this._options=copy_properties(b,c);BasePrivacyWidget.setup();}copy_properties(BasePrivacyWidget,{MAX_DESCRIPTION_LENGTH:22,setup:function(){if(BasePrivacyWidget._is_set_up)return;BasePrivacyWidget._is_set_up=true;BasePrivacyWidget.OPTIONS_TEXT={};BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.EVERYONE]=_tx(\"Everyone\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.NETWORKS_FRIENDS_OF_FRIENDS]=_tx(\"Friends of Friends and Networks\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.NETWORKS_FRIENDS]=_tx(\"Friends and Networks\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.FRIENDS_OF_FRIENDS]=_tx(\"Friends of Friends\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.ALL_FRIENDS]=_tx(\"Friends Only\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.CUSTOM]=_tx(\"Customize\");BasePrivacyWidget.OPTIONS_TEXT[PrivacyBaseValue.SELF]=_tx(\"Only Me\");}});BasePrivacyWidget.prototype={getData:function(){return this._model.getData();},getRoot:function(){return this._root;},_isCustomSetting:function(a){return (a==PrivacyBaseValue.CUSTOM);},_getSelectListLabel:function(b,a){if(a&&this._isCustomSetting(b))return _tx(\"Custom\");return BasePrivacyWidget.OPTIONS_TEXT[b];},_getPrivacySettingDescription:function(a){if(BasePrivacyWidget.OPTIONS_TEXT[a]&&a!=PrivacyBaseValue.CUSTOM)return BasePrivacyWidget.OPTIONS_TEXT[a];return _tx(\"Custom\");},_getMenuContent:function(){if(!this._selectList){this._selectList=new UISelectList();this._selectList.setMode(UISelectList.SINGLE_SELECT_MODE);this._selectList.setCallback(this._onMenuSelect.bind(this));}this._selectList.clearItems();for(var c=0;c<this._privacyOptions.length;c++){var d=this._privacyOptions[c],b=false,a=(d==this._model.value);if(this._isCustomSetting(d)&&this._isCustomSetting(this._model.value)){a=true;b=true;}var e=this._getSelectListLabel(d,a);if(a&&b)e=$N('div',{className:'UIPrivacyWidget_Custom'},[$N('span',{className:'UIPrivacyWidget_CustomLabel'},e),$N('span',{className:'UIPrivacyWidget_CustomEditLink'},_tx(\"edit\"))]);this._selectList.addItem(e,a,d);}return this._selectList.getElement();},_updateDescription:function(a){if(a.length>BasePrivacyWidget.MAX_DESCRIPTION_LENGTH)a=a.substring(0,BasePrivacyWidget.MAX_DESCRIPTION_LENGTH)+'...';this._menu.setTitle(HTML(a));if(this._options.tooltipMode)this._menu.setTooltip(a);},_resetMenu:function(a){if(!(a&&this._isCustomSetting(this._model.value)))a=this._getPrivacySettingDescription(this._model.value);this._menu.buildMenu();this._updateDescription(a);},alignPrivacyMenu:function(){CSS.addClass(this._root,'UIActionMenu_Upward');}};\nArbiter.inform(\"template\\\/registerTemplate\", {\"name\":\"\\\/templates\\\/UIActionMenu.tmpl\",\"template\":\"\\n<div class=\\\"UIActionMenu\\\" bindPoint=\\\"root\\\">\\n  <a class=\\\"UIActionMenu_Wrap\\\" bindPoint=\\\"wrap\\\" href=\\\"#\\\">\\n    <span class=\\\"UIActionMenu_Icon\\\" bindPoint=\\\"icon\\\"><\\\/span>\\n    <span class=\\\"UIActionMenu_Text\\\" bindPoint=\\\"text\\\"><\\\/span>\\n    <span class=\\\"UIActionMenu_Chevron\\\"><\\\/span>\\n  <\\\/a>\\n  <div class=\\\"UIActionMenu_Menu\\\" bindPoint=\\\"menu\\\"><\\\/div>\\n<\\\/div>\\n\"}, Arbiter.BEHAVIOR_PERSISTENT);\nfunction UISelectList(){this._callback=bagofholding;this.container=$N('div',{className:'UISelectList clearfix'});this._mode=UISelectList.MULTI_SELECT_MODE;this._inputName='UISelectList_name_'+(+new Date());this._items={};}copy_properties(UISelectList,{MULTI_SELECT_MODE:1,SINGLE_SELECT_MODE:2,MULTI_SELECT_MODE_CHECKED_CLASS_NAME:'UISelectList_check_Checked',SINGLE_SELECT_MODE_CHECKED_CLASS_NAME:'UISelectList_radio_Checked'});UISelectList.prototype={setMode:function(a){if(a!=UISelectList.MULTI_SELECT_MODE&&a!=UISelectList.SINGLE_SELECT_MODE)return this;if(!is_empty(this._items))return this;this._mode=a;return this;},setCallback:function(a){this._callback=a;return this;},addItem:function(d,a,c){var b={label:d,checked:a,key:c};this._renderItem(b);return this;},addItems:function(b){for(var a=0;a<b.length;a++)this.addItem(b[a].label,b[a].checked,b[a].key);return this;},clearItems:function(){this._items={};DOM.empty(this.container);return this;},setSelected:function(b,c){if(this._items[b]){var a=this._items[b].input;a.checked=!c;a.click();}return this;},getElement:function(){return this.container;},reset:function(){for(var b in this._items){var a=this._items[b].input;var c=this._items[b].label;a.checked=a.defaultChecked;CSS.conditionClass(c,this._getCheckedClass(),a.checked);}},_renderItem:function(b){var a=$N('input',{type:this._getInputType(),name:this._inputName});a.checked=b.checked;a.defaultChecked=b.checked;var c=$N('a',{className:'UISelectList_Label',href:'#'},b.label);if(b.checked)c.addClass(this._getCheckedClass());c.listen('click',this._linkClicked.bind(this,a));a.listen('click',this._clicked.bind(this,a,c,b.key));this.container.appendContent($N('div',{className:'UISelectList_Item'},[a,c]));b.input=a;b.label=c;this._items[b.key]=b;},_getInputType:function(){if(this._mode==UISelectList.MULTI_SELECT_MODE)return 'checkbox';return 'radio';},_getCheckedClass:function(){if(this._mode==UISelectList.MULTI_SELECT_MODE)return UISelectList.MULTI_SELECT_MODE_CHECKED_CLASS_NAME;return UISelectList.SINGLE_SELECT_MODE_CHECKED_CLASS_NAME;},_linkClicked:function(b,a){b.click();},_clicked:function(d,g,f,c){var b;if(this._mode==UISelectList.SINGLE_SELECT_MODE){for(var e in this._items){var a=d==this._items[e].input;CSS.conditionClass(this._items[e].label,this._getCheckedClass(),a);}b=true;}else{b=d.checked;CSS.conditionClass(g,this._getCheckedClass(),d.checked);}this._callback(b,f);$E(c).stop();}};\nfunction UIActionMenu(a){this.root=null;this.wrap=null;this.icon=null;this.text=null;this.menu=null;this._dirty=true;this._title=a;this._contentCallback=bagofholding;this._selectList=null;this.parent.construct(this,URI('\/templates\/UIActionMenu.tmpl'));this._initialize();}UIActionMenu.extend('TemplateObject');copy_properties(UIActionMenu,{ICONS:{LOCK:'UIActionMenu_Lock',PEOPLE:'UIActionMenu_People'},COLORS:{BLUE:'UIActionMenu_Blue'}});UIActionMenu.mixin('Arbiter',{_initialize:function(){Event.listen(this.wrap,'click',this.click.bind(this));Event.listen(this.menu,'mouseover',function(event){var a=DOM.getNearest(event.getTarget(),'a');a&&a.focus();});},hideMenu:function(){Toggler.hide();return this;},_buildAndInform:function(){if(this._dirty){this.buildMenu();this.setDirty(false);}this.inform('menuActivated');Toggler.toggle(this.wrap);},showMenu:function(){this._buildAndInform();Toggler.show(this.wrap.parentNode);return this;},click:function(event){this._buildAndInform();event.prevent();},setAlignRight:function(a){this._right=a;CSS.conditionClass(this.root,'UIActionMenu_AlignRight',a);return this;},setContentCallback:function(a){this._contentCallback=a;return this;},setSuppressButton:function(a){CSS.conditionClass(this.root,'UIActionMenu_SuppressButton',a);return this;},setSuppressText:function(a){CSS.conditionClass(this.root,'UIActionMenu_SuppressText',a);return this;},setColor:function(a){switch(a){case UIActionMenu.COLORS.BLUE:if(this.color)CSS.removeClass(this.root,this.color);CSS.addClass(this.root,a);this.color=a;break;default:if(this.color){CSS.removeClass(this.root,this.color);this.color=null;}}return this;},setIcon:function(a){switch(a){case UIActionMenu.ICONS.LOCK:case UIActionMenu.ICONS.PEOPLE:CSS.addClass(this.root,'UIActionMenu_IconIncluded');CSS.addClass(this.icon,a);break;default:CSS.removeClass(this.root,'UIActionMenu_IconIncluded');}return this;},_getContent:function(){var a=this._contentCallback();return a;},setTitle:function(a){this._title=a;DOM.setContent(this.text,this._title);return this;},setLinkTitle:function(a){this.wrap.title=a;return this;},setTooltip:function(a){if(this.tooltip){if(a){DOM.setContent(this.tooltip.firstChild,a);}else{DOM.remove(this.tooltip);CSS.removeClass(this.wrap,'uiTooltip');this.tooltip=null;}}else{this.tooltip=$N('span',{className:'uiTooltipWrap'},$N('span',{className:'uiTooltipText'},a));CSS.addClass(this.wrap,'uiTooltip');if(this._right)CSS.addClass(this.tooltip,'right');DOM.prependContent(this.wrap,this.tooltip);}return this;},getNodes:function(){DOM.setContent(this.text,this._title);return [this.root];},buildMenu:function(){DOM.setContent(this.menu,this._getContent());return this;},useSelectList:function(b,a,c){c=c||UISelectList.MULTI_SELECT_MODE;this.setContentCallback(function(){this._selectList=new UISelectList().setMode(c).setCallback(function(d,e){this.hideMenu();a&&a(d,e);}.bind(this)).addItems(b);return this._selectList.getElement();}.bind(this));return this;},resetSelectList:function(){this._selectList&&this._selectList.reset();},getSelectList:function(){return this._selectList;},setDirty:function(a){this._dirty=a;return this;}});\nfunction UIPrivacyWidget(a,b,g,c,d,f){var e={autoSave:false,alignRight:true,tooltipMode:false,saveAsDefaultFbid:0,suppressButton:true,range:[],initialExplanation:'',alignBottom:false,useLegacyFormData:false};if(b=='0')b=0;this.parent.construct(this,a,f,e);this._lists=c;this._networks=d;this._fbid=b;this._row=g;if(this._options.autoSave){if(!b)this._options.autoSave=false;if(this._options.saveAsDefaultFbid*1)this._options.saveAsDefaultFbid=0;}UIPrivacyWidget.instances[this._controllerId]=this;}copy_properties(UIPrivacyWidget,{DIALOG_URI:'\/ajax\/privacy\/privacy_widget_dialog.php',GLOBAL_PRIVACY_CHANGED_EVENT:'UIPrivacyWidget\/globalPrivacyChanged',instances:{},getInstance:function(a){return this.instances[a];}});UIPrivacyWidget.extend('BasePrivacyWidget');UIPrivacyWidget.mixin('Arbiter',{init:function(){this._menu=new UIActionMenu().setContentCallback(this._getMenuContent.bind(this)).setSuppressButton(this._options.suppressButton).setAlignRight(this._options.alignRight).setLinkTitle(this._options.linkTitle?this._options.linkTitle:_tx(\"Privacy\"));if(this._options.showLock)this._menu.setIcon(UIActionMenu.ICONS.LOCK);if(this._options.tooltipMode)this._menu.setSuppressText(true);this._menu.subscribe('menuActivated',function(){this.inform('menuActivated');}.bind(this));this.setData(this._row,this._options.initialExplanation,true);if(this._options.alignBottom)this.alignPrivacyMenu();this._saveFormData();var a=function(){DOM.appendContent(this._root,this._menu.getNodes());}.bind(this);a.defer();},_saveFormData:function(){var b=DOM.find(this._root,'div.UIPrivacyWidget_Form');DOM.empty(b);if(this._options.useLegacyFormData){var a={privacy_data:this.getData()};}else var a={privacy_data:this.getPrivacyData()};create_hidden_inputs(a,b);},_onPrivacyChanged:function(){this._saveFormData();this.inform('privacyChanged',this.getData());Arbiter.inform(UIPrivacyWidget.GLOBAL_PRIVACY_CHANGED_EVENT,{fbid:this._fbid,data:this.getData()});},reset:function(){this._model=this._originalModel.clone();this._modelClone=this._originalModel.clone();this._resetMenu();this._saveFormData();return this;},revert:function(){this._model=this._modelClone.clone();this._resetMenu(this._previousDescription);this._saveFormData();return this;},getValue:function(){return this._model.value;},getDefaultValue:function(){return this._originalModel.value;},getPrivacyData:function(a){a=a||this._fbid;var b={};b[a]=this.getData();return b;},isEveryonePrivacy:function(){return this._model.value==PrivacyBaseValue.EVERYONE;},dialogOpen:function(){return this._dialog&&this._dialog.getRoot();},setData:function(b,a,c){this._model=new PrivacyModel();this._model.init(b.value,b.friends,b.networks,b.lists,b.lists_x,b.list_anon,b.ids_anon,b.list_x_anon,b.ids_x_anon,b.tdata);this._modelClone=this._model.clone();if(this._options.range.length){this._privacyOptions=this._options.range;}else this._privacyOptions=[PrivacyBaseValue.EVERYONE,PrivacyBaseValue.NETWORKS_FRIENDS,PrivacyBaseValue.FRIENDS_OF_FRIENDS,PrivacyBaseValue.ALL_FRIENDS,PrivacyBaseValue.CUSTOM];if(is_empty(this._networks))this._privacyOptions.remove(PrivacyBaseValue.NETWORKS_FRIENDS);if(c)this._originalModel=this._model.clone();this._previousDescription=a;this._customModel=null;if(this._menu)this._resetMenu(a);},setLists:function(a){this._lists=a;return this;},setNetworks:function(a){this._networks=a;return this;},_isCustomSetting:function(a){return (a==PrivacyBaseValue.CUSTOM||a==PrivacyBaseValue.NETWORKS_FRIENDS_OF_FRIENDS||a==PrivacyBaseValue.SELF);},_onMenuSelect:function(a,c){this._modelClone=this._model.clone();var b=this._isCustomSetting(this._model.value);var d=this._isCustomSetting(c);if(b&&!d)this._customModel=this._model.clone();if(!(b&&d)){this._model.value=c;this._resetModelAuxiliaryData();}if(c==PrivacyBaseValue.CUSTOM){if(this._customModel){this._model=this._customModel.clone();}else if(this._modelClone.value!=PrivacyBaseValue.CUSTOM)this._model.friends=PrivacyFriendsValue.ALL_FRIENDS;this._showDialog();}else{this._onPrivacyChanged();if(this._options.autoSave)this._saveSetting();}this._resetMenu();this._menu.hideMenu();},_showDialog:function(){if(!this._fbid){this._model.list_x_anon=0;this._model.list_anon=0;}var a={controller_id:this._controllerId,privacy_data:this.getData(),fbid:this._fbid,save_as_default_fbid:this._options.saveAsDefaultFbid};this._dialog=new Dialog().setAsync(new AsyncRequest().setURI(UIPrivacyWidget.DIALOG_URI).setData(a)).setModal(true).show();return false;},_resetModelAuxiliaryData:function(){if(this._model.value!=PrivacyBaseValue.CUSTOM){this._model.lists_x=this._model.lists=this._model.networks=this._model.ids_anon=this._model.ids_x_anon=[];this._model.list_x_anon=0;this._model.list_anon=0;}},_saveSetting:function(a){a=a||this._fbid;new AsyncRequest().setURI('\/ajax\/privacy\/widget_save.php').setData({privacy_data:this.getPrivacyData(a),fbid:a}).setHandler(this._handleResponse.bind(this)).setErrorHandler(this._handleError.bind(this)).send();},_handleResponse:function(b){var a=b.getPayload();this.setData(a.privacy_row,a.explanation);},_handleError:function(a){this.revert();}});\nif(typeof deconcept==\"undefined\")var deconcept={};if(typeof deconcept.util==\"undefined\")deconcept.util={};if(typeof deconcept.SWFObjectUtil==\"undefined\")deconcept.SWFObjectUtil={};deconcept.SWFObject=function(h,d,j,c,i,a,f,l,g,b){if(!document.getElementById)return;this.DETECT_KEY=b?b:'detectflash';this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params={};this.variables={};this.attributes=[];this.fallback_html='';this.fallback_js_fcn=function(){};if(h)this.setAttribute('swf',h);if(d)this.setAttribute('id',d);if(j)this.setAttribute('width',j);if(c)this.setAttribute('height',c);this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(i){if(!(i instanceof Array))i=[i];var k;i.each(function(n){k=new deconcept.PlayerVersion(n.toString().split('.'));if(k.major==this.installedVer.major){this.setAttribute('version',k);return;}else if(!this.getAttribute('version')||k.major<this.getAttribute('version').major)this.setAttribute('version',k);}.bind(this));}if(!window.opera&&document.all&&this.installedVer.major>7)if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent(\"onunload\",deconcept.SWFObjectUtil.cleanupSWFs);};window.attachEvent(\"onbeforeunload\",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true;}if(a)this.addParam('bgcolor',a);var e=f?f:'high';this.addParam('quality',e);this.setAttribute('useExpressInstall',false);this.setAttribute('doExpressInstall',false);var m=(l)?l:window.location;this.setAttribute('xiRedirectUrl',m);this.setAttribute('redirectUrl','');if(g)this.setAttribute('redirectUrl',g);};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?\"\/swf\/expressinstall.swf\":a;this.setAttribute('useExpressInstall',true);},setAttribute:function(a,b){this.attributes[a]=b;},getAttribute:function(a){return this.attributes[a]||\"\";},addParam:function(a,b){this.params[a]=b;},getParams:function(){return this.params;},addVariable:function(a,b){this.variables[a]=b;},getVariable:function(a){return this.variables[a]||\"\";},getVariables:function(){return this.variables;},getVariablePairs:function(){var b=[];var a;var c=this.getVariables();for(a in c)b[b.length]=a+\"=\"+c[a];return b;},getSWFHTML:function(){var d=\"\";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"PlugIn\");this.setAttribute('swf',this.xiSWFPath);}d='<embed type=\"application\/x-shockwave-flash\" src=\"'+htmlspecialchars(this.getAttribute('swf'))+'\" width=\"'+htmlspecialchars(this.getAttribute('width'))+'\" height=\"'+htmlspecialchars(this.getAttribute('height'))+'\" style=\"'+htmlspecialchars(this.getAttribute('style')||\"\")+'\"';d+=' id=\"'+htmlspecialchars(this.getAttribute('id'))+'\" name=\"'+htmlspecialchars(this.getAttribute('id'))+'\" ';var c=this.getParams();for(var a in c)d+=htmlspecialchars(a)+'=\"'+htmlspecialchars(c[a])+'\" ';var b=this.getVariablePairs().join(\"&\");if(b.length>0)d+='flashvars=\"'+b+'\"';d+='\/>';}else{if(this.getAttribute(\"doExpressInstall\")){this.addVariable(\"MMplayerType\",\"ActiveX\");this.setAttribute('swf',this.xiSWFPath);}d='<object id=\"'+this.getAttribute('id')+'\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"'+this.getAttribute('width')+'\" height=\"'+this.getAttribute('height')+'\" style=\"'+(this.getAttribute('style')||\"\")+'\">';d+='<param name=\"movie\" value=\"'+this.getAttribute('swf')+'\" \/>';var c=this.getParams();for(var a in c)d+='<param name=\"'+a+'\" value=\"'+c[a]+'\" \/>';var b=this.getVariablePairs().join(\"&\");if(b.length>0)d+='<param name=\"flashvars\" value=\"'+b+'\" \/>';d+=\"<\/object>\";}return d;},write:function(a){if(this.getAttribute('useExpressInstall')){var b=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(b)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable(\"MMredirectURL\",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+\" - Flash Player Installation\";this.addVariable(\"MMdoctitle\",document.title);}}var c=(typeof a=='string')?document.getElementById(a):a;if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){c.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute('redirectUrl')!=\"\")document.location.replace(this.getAttribute('redirectUrl'));need_version=this.getAttribute('version').major+'.'+this.getAttribute('version').minor+'.'+this.getAttribute('version').rev;have_version=this.installedVer.major+'.'+this.installedVer.minor+'.'+this.installedVer.rev;this.fallback_js_fcn(have_version,need_version);c.innerHTML=this.fallback_html;}return false;}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var a=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){for(var d=0;d<navigator.plugins.length;d++)try{var e=navigator.plugins[d];if(e.name=='Shockwave Flash'){PlayerVersion_tmp=new deconcept.PlayerVersion(e.description.replace(\/([a-zA-Z]|\\s)+\/,\"\").replace(\/(\\s+r|\\s+b[0-9]+)\/,\".\").split(\".\"));if(typeof a=='undefined'||PlayerVersion_tmp.major>a.major||(PlayerVersion_tmp.major==a.major&&(PlayerVersion_tmp.minor>a.minor||(PlayerVersion_tmp.minor==a.minor&&PlayerVersion_tmp.rev>a.rev))))a=PlayerVersion_tmp;}}catch(honk){}}else if(navigator.userAgent&&navigator.userAgent.indexOf(\"Windows CE\")>=0){var b=1;var c=3;while(b)try{c++;b=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.\"+c);a=new deconcept.PlayerVersion([c,0,0]);}catch(e){b=null;}}else{try{var b=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.7\");}catch(e){try{var b=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash.6\");a=new deconcept.PlayerVersion([6,0,21]);b.AllowScriptAccess=\"always\";}catch(e){if(a.major==6)return a;}try{b=new ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\");}catch(e){}}if(b!=null)a=new deconcept.PlayerVersion(b.GetVariable(\"$version\").split(\" \")[1].split(\",\"));}return a;};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0;};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major)return false;if(this.major>a.major)return true;if(this.minor<a.minor)return false;if(this.minor>a.minor)return true;if(this.rev<a.rev)return false;return true;};deconcept.util={getRequestParameter:function(c){var d=document.location.search||document.location.hash;if(c==null)return d;if(d){var b=d.substring(1).split(\"&\");for(var a=0;a<b.length;a++)if(b[a].substring(0,b[a].indexOf(\"=\"))==c)return b[a].substring((b[a].indexOf(\"=\")+1));}return \"\";}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var b=document.getElementsByTagName(\"OBJECT\");for(var a=b.length-1;a>=0;a--){b[a].style.display='none';for(var c in b[a])if(typeof b[a][c]=='function')b[a][c]=function(){};}};if(!document.getElementById&&document.all)document.getElementById=function(a){return document.all[a];};var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;var flash_update_dialog_shown=false;function spawn_flash_update_dialog(a,b){if(flash_update_dialog_shown)return;flash_update_dialog_shown=true;new AsyncRequest().setURI('\/ajax\/flash_update_dialog.php').setData({have_version:a,need_version:b}).setMethod('GET').setReadOnly(true).send();}function setFlashFallback(d,g){var b=ge(d);var a=deconcept.SWFObjectUtil.getPlayerVersion();var e;g.each(function(h){h=new deconcept.PlayerVersion(h.toString().split('.'));if(h.major==a.major){e=h;return;}else if(typeof e=='undefined'||h.major<e.major)e=h;}.bind(this));if(b&&a.major>0){var c=a.major+'.'+a.minor+'.'+a.rev;var f=e.major+'.'+e.minor+'.'+e.rev;b.innerHTML=_tx(\"Flash {required-version} is required to view this content. Your current version is {current-version}. Please download the latest Flash Player.\",{'required-version':f,'current-version':c});}}function getFlashPlayer(){goURI('http:\/\/get.adobe.com\/flashplayer');return false;}\n\nif (window.Bootloader) { Bootloader.done([\"js\\\/61k4eem494g8ogko.pkg.js\"]); }")